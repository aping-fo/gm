<div class="pageContent">
    <div class="tabs" currentIndex="0">
        <div class="tabsHeader">
            <div class="tabsHeaderContent">
                <ul id="player">
                    <input type="hidden" th:value="${charId}"/>
                    <li class="selected"><a href="player/info_playerList" class="j-ajax" target="navTab"><span>玩家列表(一期)</span></a></li>
                    <li><a href="player/info_baseInformation" class="j-ajax" target="navTab"><span>基本信息(二期)</span></a></li>
                    <li><a href="player/info_equipment_flow" class="j-ajax" target="navTab"><span>流水查询(二期)</span></a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="pageHeader">
    <form id="pagerForm" onsubmit="return navTabSearch(this);" action="player/info_playerList" method="post"
          onreset="$(this).find('select.combox').comboxReset()">
        <div class="searchBar">
            <table class="searchContent">
                <tr>
                    <td>
                        <select name="searchKey" class="combox">
                            <option value="1" th:selected="(${request.searchKey} == 1)">角色名</option>
                            <option value="2" th:selected="(${request.searchKey} == 2)">账号</option>
                            <option value="3" th:selected="(${request.searchKey} == 3)">角色ID</option>
                        </select>
                        <input name="keyword" th:value="${request.keyword}"/>
                    </td>
                    <td>
                        <select name="sex" class="combox">
                            <option value="">-性别-</option>
                            <option value="1" th:selected="(${request.sex}=='1')">男</option>
                            <option value="2" th:selected="(${request.sex}=='2')">女</option>
                        </select>
                    </td>
                    <td>
                        等级：
                        <input type="number" name="levelStart" th:value="${request.levelStart}"/>
                        -
                        <input type="number" name="levelEnd" th:value="${request.levelEnd}"/>
                    </td>
                    <td>
                        元宝：
                        <input type="number" name="goldStart" th:value="${request.goldStart}"/>
                        -
                        <input type="number" name="goldEnd" th:value="${request.goldEnd}"/>
                    </td>
                    <td>
                        <select name="job" class="combox">
                            <option value="">-职业-</option>
                            <option value="1">战士</option>
                            <option value="2">刺客</option>
                            <option value="3">法师</option>
                        </select>
                    </td>
                </tr>
            </table>
        </div>
        <div th:replace="_include/searchBar"></div>
    </form>
</div>
<div class="pageContent">
    <div class="panelBar">
        <ul class="toolBar">
            <li><a class="delete" href="javascript:batchBanDialog();"><span>批量封禁</span></a></li>
        </ul>
    </div>
    <table class="table" layoutH="137">
        <thead>
        <tr>
            <th width="22"><input type="checkbox" group="ids" class="checkboxCtrl"></th>
            <th width="120">区服</th>
            <th width="120">渠道</th>
            <th width="120">账号</th>
            <th width="120">角色名</th>
            <th width="120">职业</th>
            <th width="120">性别</th>
            <th width="80" align="right">角色等级</th>
            <th width="80" align="right">剩余元宝</th>
            <th width="80" align="right">最后登录时间</th>
            <th width="220">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="row,iterStat:${characters}">
            <td><input th:if="${row.operateStatus==1}" name="ids" th:value="${row.charId}" type="checkbox"></td>
            <td th:text="${row.serverName}"></td>
            <td th:text="${row.channelName}"></td>
            <td><input type="button" th:value="${row.username}" th:onclick="'changeHref(\''+${row.charId}+'\')'"/></td>
            <td th:text="${row.charName}"></td>
            <td th:if="${row.job} eq'1'" th:text="战士"></td>
            <td th:if="${row.job} eq'2'" th:text="刺客"></td>
            <td th:if="${row.job} eq'3'" th:text="法师"></td>
            <td th:if="${row.sex} eq'1'" th:text="男"></td>
            <td th:if="${row.sex} eq'2'" th:text="女"></td>
            <td th:text="${row.level}"></td>
            <td th:text="${row.leftGold}"></td>
            <td th:text="${#dates.format(row.updateTime, 'yyyy-MM-dd')}"></td>
            <td>
                <a th:if="${row.operateStatus==1}" title="封禁" class="button" th:href="@{player/dialog_ban(charIds=${row.charId},opType='FORBIDDEN')}" target="dialog" mask="true"><span>封禁</span></a>
                <a title="踢下线" class="button" th:href="@{player/kick_line(charId=${row.charId},serverId=${row.serverId})}" target="dialog" mask="true"><span>踢下线</span></a>
                <!--<a title="闪断" class="button" th:href="@{player/flicker(charIds=${row.charId},serverId=${row.serverId})}" target="dialog" mask="true"><span>闪断</span></a>-->
            </td>
        </tr>
        </tbody>
    </table>
    <div th:replace="_include/pager"></div>
</div>
<script type="text/javascript">
    function changeHref(charId) {
        var href = $('#player a')
        href.eq(0).attr("href","player/info_playerList?charId="+charId)
        href.eq(1).attr("href","player/info_baseInformation?charId="+charId)
        href.eq(2).attr("href","player/info_equipment_flow?charId="+charId)
    }
    function changeHref2() {
        var href = $('#player a')
        var charId = $('#player input').val()
        href.eq(0).attr("href","player/info_playerList?charId="+charId)
        href.eq(1).attr("href","player/info_baseInformation?charId="+charId)
        href.eq(2).attr("href","player/info_equipment_flow?charId="+charId)
    }
    changeHref2()
    function batchBanDialog() {
        var selectIds = $.getSelectedIds("ids");
        alert(selectIds);
        var url = "player/dialog_ban";
        url += "?charIds=" + selectIds;
        url += "&opType=FORBIDDEN";
        $.pdialog.open(url, 'batchBan', '批量封禁', {mask: true});
    }
</script>